{"dependencies":[{"name":"@supabase/supabase-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":53,"index":53}}],"key":"bIfLatK31tbWgCp34BhPDdikyTA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"supabase\", {\n    enumerable: true,\n    get: function () {\n      return supabase;\n    }\n  });\n  Object.defineProperty(exports, \"AVATAR_BUCKET\", {\n    enumerable: true,\n    get: function () {\n      return AVATAR_BUCKET;\n    }\n  });\n  exports.uploadAvatar = uploadAvatar;\n  exports.deleteAvatar = deleteAvatar;\n  var _supabaseSupabaseJs = require(_dependencyMap[0], \"@supabase/supabase-js\");\n  const SUPABASE_URL = 'https://jetyqazmgbucawylpvq.supabase.co';\n  const SUPABASE_ANON_KEY = 'sb_publishable_ZtgCAEJ1OvcXOYzJhpzs1w_ysRPDrGf';\n  const supabase = (0, _supabaseSupabaseJs.createClient)(SUPABASE_URL, SUPABASE_ANON_KEY);\n  const AVATAR_BUCKET = 'avatars';\n\n  // Upload image to Supabase Storage\n  async function uploadAvatar(userId, base64Image, mimeType = 'image/jpeg') {\n    // Convert base64 to blob\n    const base64Data = base64Image.replace(/^data:image\\/\\w+;base64,/, '');\n    const byteCharacters = atob(base64Data);\n    const byteNumbers = new Array(byteCharacters.length);\n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    const byteArray = new Uint8Array(byteNumbers);\n    const blob = new Blob([byteArray], {\n      type: mimeType\n    });\n\n    // Generate unique filename\n    const fileExt = mimeType.split('/')[1] || 'jpeg';\n    const fileName = `${userId}_${Date.now()}.${fileExt}`;\n    const filePath = `${fileName}`;\n\n    // Upload to Supabase Storage\n    const {\n      data,\n      error\n    } = await supabase.storage.from(AVATAR_BUCKET).upload(filePath, blob, {\n      contentType: mimeType,\n      upsert: true\n    });\n    if (error) {\n      console.error('Upload error:', error);\n      throw new Error(`Failed to upload avatar: ${error.message}`);\n    }\n\n    // Get public URL\n    const {\n      data: urlData\n    } = supabase.storage.from(AVATAR_BUCKET).getPublicUrl(filePath);\n    return urlData.publicUrl;\n  }\n\n  // Delete avatar from Supabase Storage\n  async function deleteAvatar(photoUrl) {\n    // Extract filename from URL\n    const urlParts = photoUrl.split('/');\n    const fileName = urlParts[urlParts.length - 1];\n    if (fileName) {\n      const {\n        error\n      } = await supabase.storage.from(AVATAR_BUCKET).remove([fileName]);\n      if (error) {\n        console.error('Delete error:', error);\n      }\n    }\n  }\n});","lineCount":80,"map":[[7,2,6,0,"Object"],[7,8,6,0],[7,9,6,0,"defineProperty"],[7,23,6,0],[7,24,6,0,"exports"],[7,31,6,0],[8,4,6,0,"enumerable"],[8,14,6,0],[9,4,6,0,"get"],[9,7,6,0],[9,18,6,0,"get"],[9,19,6,0],[10,6,6,0],[10,13,6,0,"supabase"],[10,21,6,0],[11,4,6,0],[12,2,6,0],[13,2,8,0,"Object"],[13,8,8,0],[13,9,8,0,"defineProperty"],[13,23,8,0],[13,24,8,0,"exports"],[13,31,8,0],[14,4,8,0,"enumerable"],[14,14,8,0],[15,4,8,0,"get"],[15,7,8,0],[15,18,8,0,"get"],[15,19,8,0],[16,6,8,0],[16,13,8,0,"AVATAR_BUCKET"],[16,26,8,0],[17,4,8,0],[18,2,8,0],[19,2,11,0,"exports"],[19,9,11,0],[19,10,11,0,"uploadAvatar"],[19,22,11,0],[19,25,11,0,"uploadAvatar"],[19,37,11,0],[20,2,55,0,"exports"],[20,9,55,0],[20,10,55,0,"deleteAvatar"],[20,22,55,0],[20,25,55,0,"deleteAvatar"],[20,37,55,0],[21,2,1,0],[21,6,1,0,"_supabaseSupabaseJs"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,3,0],[22,8,3,6,"SUPABASE_URL"],[22,20,3,18],[22,23,3,21],[22,64,3,62],[23,2,4,0],[23,8,4,6,"SUPABASE_ANON_KEY"],[23,25,4,23],[23,28,4,26],[23,76,4,74],[24,2,6,7],[24,8,6,13,"supabase"],[24,16,6,21],[24,19,6,24],[24,23,6,24,"createClient"],[24,42,6,36],[24,43,6,36,"createClient"],[24,55,6,36],[24,57,6,37,"SUPABASE_URL"],[24,69,6,49],[24,71,6,51,"SUPABASE_ANON_KEY"],[24,88,6,68],[24,89,6,69],[25,2,8,7],[25,8,8,13,"AVATAR_BUCKET"],[25,21,8,26],[25,24,8,29],[25,33,8,38],[27,2,10,0],[28,2,11,7],[28,17,11,22,"uploadAvatar"],[28,29,11,34,"uploadAvatar"],[28,30,12,2,"userId"],[28,36,12,16],[28,38,13,2,"base64Image"],[28,49,13,21],[28,51,14,2,"mimeType"],[28,59,14,18],[28,62,14,21],[28,74,14,33],[28,76,15,19],[29,4,16,2],[30,4,17,2],[30,10,17,8,"base64Data"],[30,20,17,18],[30,23,17,21,"base64Image"],[30,34,17,32],[30,35,17,33,"replace"],[30,42,17,40],[30,43,17,41],[30,69,17,67],[30,71,17,69],[30,73,17,71],[30,74,17,72],[31,4,18,2],[31,10,18,8,"byteCharacters"],[31,24,18,22],[31,27,18,25,"atob"],[31,31,18,29],[31,32,18,30,"base64Data"],[31,42,18,40],[31,43,18,41],[32,4,19,2],[32,10,19,8,"byteNumbers"],[32,21,19,19],[32,24,19,22],[32,28,19,26,"Array"],[32,33,19,31],[32,34,19,32,"byteCharacters"],[32,48,19,46],[32,49,19,47,"length"],[32,55,19,53],[32,56,19,54],[33,4,21,2],[33,9,21,7],[33,13,21,11,"i"],[33,14,21,12],[33,17,21,15],[33,18,21,16],[33,20,21,18,"i"],[33,21,21,19],[33,24,21,22,"byteCharacters"],[33,38,21,36],[33,39,21,37,"length"],[33,45,21,43],[33,47,21,45,"i"],[33,48,21,46],[33,50,21,48],[33,52,21,50],[34,6,22,4,"byteNumbers"],[34,17,22,15],[34,18,22,16,"i"],[34,19,22,17],[34,20,22,18],[34,23,22,21,"byteCharacters"],[34,37,22,35],[34,38,22,36,"charCodeAt"],[34,48,22,46],[34,49,22,47,"i"],[34,50,22,48],[34,51,22,49],[35,4,23,2],[36,4,25,2],[36,10,25,8,"byteArray"],[36,19,25,17],[36,22,25,20],[36,26,25,24,"Uint8Array"],[36,36,25,34],[36,37,25,35,"byteNumbers"],[36,48,25,46],[36,49,25,47],[37,4,26,2],[37,10,26,8,"blob"],[37,14,26,12],[37,17,26,15],[37,21,26,19,"Blob"],[37,25,26,23],[37,26,26,24],[37,27,26,25,"byteArray"],[37,36,26,34],[37,37,26,35],[37,39,26,37],[38,6,26,39,"type"],[38,10,26,43],[38,12,26,45,"mimeType"],[39,4,26,54],[39,5,26,55],[39,6,26,56],[41,4,28,2],[42,4,29,2],[42,10,29,8,"fileExt"],[42,17,29,15],[42,20,29,18,"mimeType"],[42,28,29,26],[42,29,29,27,"split"],[42,34,29,32],[42,35,29,33],[42,38,29,36],[42,39,29,37],[42,40,29,38],[42,41,29,39],[42,42,29,40],[42,46,29,44],[42,52,29,50],[43,4,30,2],[43,10,30,8,"fileName"],[43,18,30,16],[43,21,30,19],[43,24,30,22,"userId"],[43,30,30,28],[43,34,30,32,"Date"],[43,38,30,36],[43,39,30,37,"now"],[43,42,30,40],[43,43,30,41],[43,44,30,42],[43,48,30,46,"fileExt"],[43,55,30,53],[43,57,30,55],[44,4,31,2],[44,10,31,8,"filePath"],[44,18,31,16],[44,21,31,19],[44,24,31,22,"fileName"],[44,32,31,30],[44,34,31,32],[46,4,33,2],[47,4,34,2],[47,10,34,8],[48,6,34,10,"data"],[48,10,34,14],[49,6,34,16,"error"],[50,4,34,22],[50,5,34,23],[50,8,34,26],[50,14,34,32,"supabase"],[50,22,34,40],[50,23,34,41,"storage"],[50,30,34,48],[50,31,35,5,"from"],[50,35,35,9],[50,36,35,10,"AVATAR_BUCKET"],[50,49,35,23],[50,50,35,24],[50,51,36,5,"upload"],[50,57,36,11],[50,58,36,12,"filePath"],[50,66,36,20],[50,68,36,22,"blob"],[50,72,36,26],[50,74,36,28],[51,6,37,6,"contentType"],[51,17,37,17],[51,19,37,19,"mimeType"],[51,27,37,27],[52,6,38,6,"upsert"],[52,12,38,12],[52,14,38,14],[53,4,39,4],[53,5,39,5],[53,6,39,6],[54,4,41,2],[54,8,41,6,"error"],[54,13,41,11],[54,15,41,13],[55,6,42,4,"console"],[55,13,42,11],[55,14,42,12,"error"],[55,19,42,17],[55,20,42,18],[55,35,42,33],[55,37,42,35,"error"],[55,42,42,40],[55,43,42,41],[56,6,43,4],[56,12,43,10],[56,16,43,14,"Error"],[56,21,43,19],[56,22,43,20],[56,50,43,48,"error"],[56,55,43,53],[56,56,43,54,"message"],[56,63,43,61],[56,65,43,63],[56,66,43,64],[57,4,44,2],[59,4,46,2],[60,4,47,2],[60,10,47,8],[61,6,47,10,"data"],[61,10,47,14],[61,12,47,16,"urlData"],[62,4,47,24],[62,5,47,25],[62,8,47,28,"supabase"],[62,16,47,36],[62,17,47,37,"storage"],[62,24,47,44],[62,25,48,5,"from"],[62,29,48,9],[62,30,48,10,"AVATAR_BUCKET"],[62,43,48,23],[62,44,48,24],[62,45,49,5,"getPublicUrl"],[62,57,49,17],[62,58,49,18,"filePath"],[62,66,49,26],[62,67,49,27],[63,4,51,2],[63,11,51,9,"urlData"],[63,18,51,16],[63,19,51,17,"publicUrl"],[63,28,51,26],[64,2,52,0],[66,2,54,0],[67,2,55,7],[67,17,55,22,"deleteAvatar"],[67,29,55,34,"deleteAvatar"],[67,30,55,35,"photoUrl"],[67,38,55,51],[67,40,55,68],[68,4,56,2],[69,4,57,2],[69,10,57,8,"urlParts"],[69,18,57,16],[69,21,57,19,"photoUrl"],[69,29,57,27],[69,30,57,28,"split"],[69,35,57,33],[69,36,57,34],[69,39,57,37],[69,40,57,38],[70,4,58,2],[70,10,58,8,"fileName"],[70,18,58,16],[70,21,58,19,"urlParts"],[70,29,58,27],[70,30,58,28,"urlParts"],[70,38,58,36],[70,39,58,37,"length"],[70,45,58,43],[70,48,58,46],[70,49,58,47],[70,50,58,48],[71,4,60,2],[71,8,60,6,"fileName"],[71,16,60,14],[71,18,60,16],[72,6,61,4],[72,12,61,10],[73,8,61,12,"error"],[74,6,61,18],[74,7,61,19],[74,10,61,22],[74,16,61,28,"supabase"],[74,24,61,36],[74,25,61,37,"storage"],[74,32,61,44],[74,33,62,7,"from"],[74,37,62,11],[74,38,62,12,"AVATAR_BUCKET"],[74,51,62,25],[74,52,62,26],[74,53,63,7,"remove"],[74,59,63,13],[74,60,63,14],[74,61,63,15,"fileName"],[74,69,63,23],[74,70,63,24],[74,71,63,25],[75,6,65,4],[75,10,65,8,"error"],[75,15,65,13],[75,17,65,15],[76,8,66,6,"console"],[76,15,66,13],[76,16,66,14,"error"],[76,21,66,19],[76,22,66,20],[76,37,66,35],[76,39,66,37,"error"],[76,44,66,42],[76,45,66,43],[77,6,67,4],[78,4,68,2],[79,2,69,0],[80,0,69,1],[80,3]],"functionMap":{"names":["<global>","uploadAvatar","deleteAvatar"],"mappings":"AAA;OCU;CDyC;OEG;CFc"},"hasCjsExports":false},"type":"js/module"}]}