{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  /*\n    This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n    License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n  */\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.REALTIME_PRESENCE_LISTEN_EVENTS = void 0;\n  var REALTIME_PRESENCE_LISTEN_EVENTS;\n  (function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n  })(REALTIME_PRESENCE_LISTEN_EVENTS || (exports.REALTIME_PRESENCE_LISTEN_EVENTS = REALTIME_PRESENCE_LISTEN_EVENTS = {}));\n  class RealtimePresence {\n    /**\n     * Creates a Presence helper that keeps the local presence state in sync with the server.\n     *\n     * @param channel - The realtime channel to bind to.\n     * @param opts - Optional custom event names, e.g. `{ events: { state: 'state', diff: 'diff' } }`.\n     *\n     * @example\n     * ```ts\n     * const presence = new RealtimePresence(channel)\n     *\n     * channel.on('presence', ({ event, key }) => {\n     *   console.log(`Presence ${event} on ${key}`)\n     * })\n     * ```\n     */\n    constructor(channel, opts) {\n      this.channel = channel;\n      this.state = {};\n      this.pendingDiffs = [];\n      this.joinRef = null;\n      this.enabled = false;\n      this.caller = {\n        onJoin: () => {},\n        onLeave: () => {},\n        onSync: () => {}\n      };\n      const events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\n        state: 'presence_state',\n        diff: 'presence_diff'\n      };\n      this.channel._on(events.state, {}, newState => {\n        const {\n          onJoin,\n          onLeave,\n          onSync\n        } = this.caller;\n        this.joinRef = this.channel._joinRef();\n        this.state = RealtimePresence.syncState(this.state, newState, onJoin, onLeave);\n        this.pendingDiffs.forEach(diff => {\n          this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n        });\n        this.pendingDiffs = [];\n        onSync();\n      });\n      this.channel._on(events.diff, {}, diff => {\n        const {\n          onJoin,\n          onLeave,\n          onSync\n        } = this.caller;\n        if (this.inPendingSyncState()) {\n          this.pendingDiffs.push(diff);\n        } else {\n          this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n          onSync();\n        }\n      });\n      this.onJoin((key, currentPresences, newPresences) => {\n        this.channel._trigger('presence', {\n          event: 'join',\n          key,\n          currentPresences,\n          newPresences\n        });\n      });\n      this.onLeave((key, currentPresences, leftPresences) => {\n        this.channel._trigger('presence', {\n          event: 'leave',\n          key,\n          currentPresences,\n          leftPresences\n        });\n      });\n      this.onSync(() => {\n        this.channel._trigger('presence', {\n          event: 'sync'\n        });\n      });\n    }\n    /**\n     * Used to sync the list of presences on the server with the\n     * client's state.\n     *\n     * An optional `onJoin` and `onLeave` callback can be provided to\n     * react to changes in the client's local presences across\n     * disconnects and reconnects with the server.\n     *\n     * @internal\n     */\n    static syncState(currentState, newState, onJoin, onLeave) {\n      const state = this.cloneDeep(currentState);\n      const transformedState = this.transformState(newState);\n      const joins = {};\n      const leaves = {};\n      this.map(state, (key, presences) => {\n        if (!transformedState[key]) {\n          leaves[key] = presences;\n        }\n      });\n      this.map(transformedState, (key, newPresences) => {\n        const currentPresences = state[key];\n        if (currentPresences) {\n          const newPresenceRefs = newPresences.map(m => m.presence_ref);\n          const curPresenceRefs = currentPresences.map(m => m.presence_ref);\n          const joinedPresences = newPresences.filter(m => curPresenceRefs.indexOf(m.presence_ref) < 0);\n          const leftPresences = currentPresences.filter(m => newPresenceRefs.indexOf(m.presence_ref) < 0);\n          if (joinedPresences.length > 0) {\n            joins[key] = joinedPresences;\n          }\n          if (leftPresences.length > 0) {\n            leaves[key] = leftPresences;\n          }\n        } else {\n          joins[key] = newPresences;\n        }\n      });\n      return this.syncDiff(state, {\n        joins,\n        leaves\n      }, onJoin, onLeave);\n    }\n    /**\n     * Used to sync a diff of presence join and leave events from the\n     * server, as they happen.\n     *\n     * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n     * `onLeave` callbacks to react to a user joining or leaving from a\n     * device.\n     *\n     * @internal\n     */\n    static syncDiff(state, diff, onJoin, onLeave) {\n      const {\n        joins,\n        leaves\n      } = {\n        joins: this.transformState(diff.joins),\n        leaves: this.transformState(diff.leaves)\n      };\n      if (!onJoin) {\n        onJoin = () => {};\n      }\n      if (!onLeave) {\n        onLeave = () => {};\n      }\n      this.map(joins, (key, newPresences) => {\n        var _a;\n        const currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\n        state[key] = this.cloneDeep(newPresences);\n        if (currentPresences.length > 0) {\n          const joinedPresenceRefs = state[key].map(m => m.presence_ref);\n          const curPresences = currentPresences.filter(m => joinedPresenceRefs.indexOf(m.presence_ref) < 0);\n          state[key].unshift(...curPresences);\n        }\n        onJoin(key, currentPresences, newPresences);\n      });\n      this.map(leaves, (key, leftPresences) => {\n        let currentPresences = state[key];\n        if (!currentPresences) return;\n        const presenceRefsToRemove = leftPresences.map(m => m.presence_ref);\n        currentPresences = currentPresences.filter(m => presenceRefsToRemove.indexOf(m.presence_ref) < 0);\n        state[key] = currentPresences;\n        onLeave(key, currentPresences, leftPresences);\n        if (currentPresences.length === 0) delete state[key];\n      });\n      return state;\n    }\n    /** @internal */\n    static map(obj, func) {\n      return Object.getOwnPropertyNames(obj).map(key => func(key, obj[key]));\n    }\n    /**\n     * Remove 'metas' key\n     * Change 'phx_ref' to 'presence_ref'\n     * Remove 'phx_ref' and 'phx_ref_prev'\n     *\n     * @example\n     * // returns {\n     *  abc123: [\n     *    { presence_ref: '2', user_id: 1 },\n     *    { presence_ref: '3', user_id: 2 }\n     *  ]\n     * }\n     * RealtimePresence.transformState({\n     *  abc123: {\n     *    metas: [\n     *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n     *      { phx_ref: '3', user_id: 2 }\n     *    ]\n     *  }\n     * })\n     *\n     * @internal\n     */\n    static transformState(state) {\n      state = this.cloneDeep(state);\n      return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n        const presences = state[key];\n        if ('metas' in presences) {\n          newState[key] = presences.metas.map(presence => {\n            presence['presence_ref'] = presence['phx_ref'];\n            delete presence['phx_ref'];\n            delete presence['phx_ref_prev'];\n            return presence;\n          });\n        } else {\n          newState[key] = presences;\n        }\n        return newState;\n      }, {});\n    }\n    /** @internal */\n    static cloneDeep(obj) {\n      return JSON.parse(JSON.stringify(obj));\n    }\n    /** @internal */\n    onJoin(callback) {\n      this.caller.onJoin = callback;\n    }\n    /** @internal */\n    onLeave(callback) {\n      this.caller.onLeave = callback;\n    }\n    /** @internal */\n    onSync(callback) {\n      this.caller.onSync = callback;\n    }\n    /** @internal */\n    inPendingSyncState() {\n      return !this.joinRef || this.joinRef !== this.channel._joinRef();\n    }\n  }\n  exports.default = RealtimePresence;\n});","lineCount":252,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[5,0,3,0],[6,0,4,0],[7,0,5,0],[8,2,6,0,"Object"],[8,8,6,6],[8,9,6,7,"defineProperty"],[8,23,6,21],[8,24,6,22,"exports"],[8,31,6,29],[8,33,6,31],[8,45,6,43],[8,47,6,45],[9,4,6,47,"value"],[9,9,6,52],[9,11,6,54],[10,2,6,59],[10,3,6,60],[10,4,6,61],[11,2,7,0,"exports"],[11,9,7,7],[11,10,7,8,"REALTIME_PRESENCE_LISTEN_EVENTS"],[11,41,7,39],[11,44,7,42],[11,49,7,47],[11,50,7,48],[12,2,8,0],[12,6,8,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[12,37,8,35],[13,2,9,0],[13,3,9,1],[13,13,9,11,"REALTIME_PRESENCE_LISTEN_EVENTS"],[13,44,9,42],[13,46,9,44],[14,4,10,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[14,35,10,35],[14,36,10,36],[14,42,10,42],[14,43,10,43],[14,46,10,46],[14,52,10,52],[15,4,11,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[15,35,11,35],[15,36,11,36],[15,42,11,42],[15,43,11,43],[15,46,11,46],[15,52,11,52],[16,4,12,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[16,35,12,35],[16,36,12,36],[16,43,12,43],[16,44,12,44],[16,47,12,47],[16,54,12,54],[17,2,13,0],[17,3,13,1],[17,5,13,3,"REALTIME_PRESENCE_LISTEN_EVENTS"],[17,36,13,34],[17,41,13,39,"exports"],[17,48,13,46],[17,49,13,47,"REALTIME_PRESENCE_LISTEN_EVENTS"],[17,80,13,78],[17,83,13,81,"REALTIME_PRESENCE_LISTEN_EVENTS"],[17,114,13,112],[17,117,13,115],[17,118,13,116],[17,119,13,117],[17,120,13,118],[17,121,13,119],[18,2,14,0],[18,8,14,6,"RealtimePresence"],[18,24,14,22],[18,25,14,23],[19,4,15,4],[20,0,16,0],[21,0,17,0],[22,0,18,0],[23,0,19,0],[24,0,20,0],[25,0,21,0],[26,0,22,0],[27,0,23,0],[28,0,24,0],[29,0,25,0],[30,0,26,0],[31,0,27,0],[32,0,28,0],[33,0,29,0],[34,4,30,4,"constructor"],[34,15,30,15,"constructor"],[34,16,30,16,"channel"],[34,23,30,23],[34,25,30,25,"opts"],[34,29,30,29],[34,31,30,31],[35,6,31,8],[35,10,31,12],[35,11,31,13,"channel"],[35,18,31,20],[35,21,31,23,"channel"],[35,28,31,30],[36,6,32,8],[36,10,32,12],[36,11,32,13,"state"],[36,16,32,18],[36,19,32,21],[36,20,32,22],[36,21,32,23],[37,6,33,8],[37,10,33,12],[37,11,33,13,"pendingDiffs"],[37,23,33,25],[37,26,33,28],[37,28,33,30],[38,6,34,8],[38,10,34,12],[38,11,34,13,"joinRef"],[38,18,34,20],[38,21,34,23],[38,25,34,27],[39,6,35,8],[39,10,35,12],[39,11,35,13,"enabled"],[39,18,35,20],[39,21,35,23],[39,26,35,28],[40,6,36,8],[40,10,36,12],[40,11,36,13,"caller"],[40,17,36,19],[40,20,36,22],[41,8,37,12,"onJoin"],[41,14,37,18],[41,16,37,20,"onJoin"],[41,17,37,20],[41,22,37,26],[41,23,37,28],[41,24,37,29],[42,8,38,12,"onLeave"],[42,15,38,19],[42,17,38,21,"onLeave"],[42,18,38,21],[42,23,38,27],[42,24,38,29],[42,25,38,30],[43,8,39,12,"onSync"],[43,14,39,18],[43,16,39,20,"onSync"],[43,17,39,20],[43,22,39,26],[43,23,39,28],[44,6,40,8],[44,7,40,9],[45,6,41,8],[45,12,41,14,"events"],[45,18,41,20],[45,21,41,23],[45,22,41,24,"opts"],[45,26,41,28],[45,31,41,33],[45,35,41,37],[45,39,41,41,"opts"],[45,43,41,45],[45,48,41,50],[45,53,41,55],[45,54,41,56],[45,57,41,59],[45,62,41,64],[45,63,41,65],[45,66,41,68,"opts"],[45,70,41,72],[45,71,41,73,"events"],[45,77,41,79],[45,82,41,84],[46,8,42,12,"state"],[46,13,42,17],[46,15,42,19],[46,31,42,35],[47,8,43,12,"diff"],[47,12,43,16],[47,14,43,18],[48,6,44,8],[48,7,44,9],[49,6,45,8],[49,10,45,12],[49,11,45,13,"channel"],[49,18,45,20],[49,19,45,21,"_on"],[49,22,45,24],[49,23,45,25,"events"],[49,29,45,31],[49,30,45,32,"state"],[49,35,45,37],[49,37,45,39],[49,38,45,40],[49,39,45,41],[49,41,45,44,"newState"],[49,49,45,52],[49,53,45,57],[50,8,46,12],[50,14,46,18],[51,10,46,20,"onJoin"],[51,16,46,26],[52,10,46,28,"onLeave"],[52,17,46,35],[53,10,46,37,"onSync"],[54,8,46,44],[54,9,46,45],[54,12,46,48],[54,16,46,52],[54,17,46,53,"caller"],[54,23,46,59],[55,8,47,12],[55,12,47,16],[55,13,47,17,"joinRef"],[55,20,47,24],[55,23,47,27],[55,27,47,31],[55,28,47,32,"channel"],[55,35,47,39],[55,36,47,40,"_joinRef"],[55,44,47,48],[55,45,47,49],[55,46,47,50],[56,8,48,12],[56,12,48,16],[56,13,48,17,"state"],[56,18,48,22],[56,21,48,25,"RealtimePresence"],[56,37,48,41],[56,38,48,42,"syncState"],[56,47,48,51],[56,48,48,52],[56,52,48,56],[56,53,48,57,"state"],[56,58,48,62],[56,60,48,64,"newState"],[56,68,48,72],[56,70,48,74,"onJoin"],[56,76,48,80],[56,78,48,82,"onLeave"],[56,85,48,89],[56,86,48,90],[57,8,49,12],[57,12,49,16],[57,13,49,17,"pendingDiffs"],[57,25,49,29],[57,26,49,30,"forEach"],[57,33,49,37],[57,34,49,39,"diff"],[57,38,49,43],[57,42,49,48],[58,10,50,16],[58,14,50,20],[58,15,50,21,"state"],[58,20,50,26],[58,23,50,29,"RealtimePresence"],[58,39,50,45],[58,40,50,46,"syncDiff"],[58,48,50,54],[58,49,50,55],[58,53,50,59],[58,54,50,60,"state"],[58,59,50,65],[58,61,50,67,"diff"],[58,65,50,71],[58,67,50,73,"onJoin"],[58,73,50,79],[58,75,50,81,"onLeave"],[58,82,50,88],[58,83,50,89],[59,8,51,12],[59,9,51,13],[59,10,51,14],[60,8,52,12],[60,12,52,16],[60,13,52,17,"pendingDiffs"],[60,25,52,29],[60,28,52,32],[60,30,52,34],[61,8,53,12,"onSync"],[61,14,53,18],[61,15,53,19],[61,16,53,20],[62,6,54,8],[62,7,54,9],[62,8,54,10],[63,6,55,8],[63,10,55,12],[63,11,55,13,"channel"],[63,18,55,20],[63,19,55,21,"_on"],[63,22,55,24],[63,23,55,25,"events"],[63,29,55,31],[63,30,55,32,"diff"],[63,34,55,36],[63,36,55,38],[63,37,55,39],[63,38,55,40],[63,40,55,43,"diff"],[63,44,55,47],[63,48,55,52],[64,8,56,12],[64,14,56,18],[65,10,56,20,"onJoin"],[65,16,56,26],[66,10,56,28,"onLeave"],[66,17,56,35],[67,10,56,37,"onSync"],[68,8,56,44],[68,9,56,45],[68,12,56,48],[68,16,56,52],[68,17,56,53,"caller"],[68,23,56,59],[69,8,57,12],[69,12,57,16],[69,16,57,20],[69,17,57,21,"inPendingSyncState"],[69,35,57,39],[69,36,57,40],[69,37,57,41],[69,39,57,43],[70,10,58,16],[70,14,58,20],[70,15,58,21,"pendingDiffs"],[70,27,58,33],[70,28,58,34,"push"],[70,32,58,38],[70,33,58,39,"diff"],[70,37,58,43],[70,38,58,44],[71,8,59,12],[71,9,59,13],[71,15,60,17],[72,10,61,16],[72,14,61,20],[72,15,61,21,"state"],[72,20,61,26],[72,23,61,29,"RealtimePresence"],[72,39,61,45],[72,40,61,46,"syncDiff"],[72,48,61,54],[72,49,61,55],[72,53,61,59],[72,54,61,60,"state"],[72,59,61,65],[72,61,61,67,"diff"],[72,65,61,71],[72,67,61,73,"onJoin"],[72,73,61,79],[72,75,61,81,"onLeave"],[72,82,61,88],[72,83,61,89],[73,10,62,16,"onSync"],[73,16,62,22],[73,17,62,23],[73,18,62,24],[74,8,63,12],[75,6,64,8],[75,7,64,9],[75,8,64,10],[76,6,65,8],[76,10,65,12],[76,11,65,13,"onJoin"],[76,17,65,19],[76,18,65,20],[76,19,65,21,"key"],[76,22,65,24],[76,24,65,26,"currentPresences"],[76,40,65,42],[76,42,65,44,"newPresences"],[76,54,65,56],[76,59,65,61],[77,8,66,12],[77,12,66,16],[77,13,66,17,"channel"],[77,20,66,24],[77,21,66,25,"_trigger"],[77,29,66,33],[77,30,66,34],[77,40,66,44],[77,42,66,46],[78,10,67,16,"event"],[78,15,67,21],[78,17,67,23],[78,23,67,29],[79,10,68,16,"key"],[79,13,68,19],[80,10,69,16,"currentPresences"],[80,26,69,32],[81,10,70,16,"newPresences"],[82,8,71,12],[82,9,71,13],[82,10,71,14],[83,6,72,8],[83,7,72,9],[83,8,72,10],[84,6,73,8],[84,10,73,12],[84,11,73,13,"onLeave"],[84,18,73,20],[84,19,73,21],[84,20,73,22,"key"],[84,23,73,25],[84,25,73,27,"currentPresences"],[84,41,73,43],[84,43,73,45,"leftPresences"],[84,56,73,58],[84,61,73,63],[85,8,74,12],[85,12,74,16],[85,13,74,17,"channel"],[85,20,74,24],[85,21,74,25,"_trigger"],[85,29,74,33],[85,30,74,34],[85,40,74,44],[85,42,74,46],[86,10,75,16,"event"],[86,15,75,21],[86,17,75,23],[86,24,75,30],[87,10,76,16,"key"],[87,13,76,19],[88,10,77,16,"currentPresences"],[88,26,77,32],[89,10,78,16,"leftPresences"],[90,8,79,12],[90,9,79,13],[90,10,79,14],[91,6,80,8],[91,7,80,9],[91,8,80,10],[92,6,81,8],[92,10,81,12],[92,11,81,13,"onSync"],[92,17,81,19],[92,18,81,20],[92,24,81,26],[93,8,82,12],[93,12,82,16],[93,13,82,17,"channel"],[93,20,82,24],[93,21,82,25,"_trigger"],[93,29,82,33],[93,30,82,34],[93,40,82,44],[93,42,82,46],[94,10,82,48,"event"],[94,15,82,53],[94,17,82,55],[95,8,82,62],[95,9,82,63],[95,10,82,64],[96,6,83,8],[96,7,83,9],[96,8,83,10],[97,4,84,4],[98,4,85,4],[99,0,86,0],[100,0,87,0],[101,0,88,0],[102,0,89,0],[103,0,90,0],[104,0,91,0],[105,0,92,0],[106,0,93,0],[107,0,94,0],[108,4,95,4],[108,11,95,11,"syncState"],[108,20,95,20,"syncState"],[108,21,95,21,"currentState"],[108,33,95,33],[108,35,95,35,"newState"],[108,43,95,43],[108,45,95,45,"onJoin"],[108,51,95,51],[108,53,95,53,"onLeave"],[108,60,95,60],[108,62,95,62],[109,6,96,8],[109,12,96,14,"state"],[109,17,96,19],[109,20,96,22],[109,24,96,26],[109,25,96,27,"cloneDeep"],[109,34,96,36],[109,35,96,37,"currentState"],[109,47,96,49],[109,48,96,50],[110,6,97,8],[110,12,97,14,"transformedState"],[110,28,97,30],[110,31,97,33],[110,35,97,37],[110,36,97,38,"transformState"],[110,50,97,52],[110,51,97,53,"newState"],[110,59,97,61],[110,60,97,62],[111,6,98,8],[111,12,98,14,"joins"],[111,17,98,19],[111,20,98,22],[111,21,98,23],[111,22,98,24],[112,6,99,8],[112,12,99,14,"leaves"],[112,18,99,20],[112,21,99,23],[112,22,99,24],[112,23,99,25],[113,6,100,8],[113,10,100,12],[113,11,100,13,"map"],[113,14,100,16],[113,15,100,17,"state"],[113,20,100,22],[113,22,100,24],[113,23,100,25,"key"],[113,26,100,28],[113,28,100,30,"presences"],[113,37,100,39],[113,42,100,44],[114,8,101,12],[114,12,101,16],[114,13,101,17,"transformedState"],[114,29,101,33],[114,30,101,34,"key"],[114,33,101,37],[114,34,101,38],[114,36,101,40],[115,10,102,16,"leaves"],[115,16,102,22],[115,17,102,23,"key"],[115,20,102,26],[115,21,102,27],[115,24,102,30,"presences"],[115,33,102,39],[116,8,103,12],[117,6,104,8],[117,7,104,9],[117,8,104,10],[118,6,105,8],[118,10,105,12],[118,11,105,13,"map"],[118,14,105,16],[118,15,105,17,"transformedState"],[118,31,105,33],[118,33,105,35],[118,34,105,36,"key"],[118,37,105,39],[118,39,105,41,"newPresences"],[118,51,105,53],[118,56,105,58],[119,8,106,12],[119,14,106,18,"currentPresences"],[119,30,106,34],[119,33,106,37,"state"],[119,38,106,42],[119,39,106,43,"key"],[119,42,106,46],[119,43,106,47],[120,8,107,12],[120,12,107,16,"currentPresences"],[120,28,107,32],[120,30,107,34],[121,10,108,16],[121,16,108,22,"newPresenceRefs"],[121,31,108,37],[121,34,108,40,"newPresences"],[121,46,108,52],[121,47,108,53,"map"],[121,50,108,56],[121,51,108,58,"m"],[121,52,108,59],[121,56,108,64,"m"],[121,57,108,65],[121,58,108,66,"presence_ref"],[121,70,108,78],[121,71,108,79],[122,10,109,16],[122,16,109,22,"curPresenceRefs"],[122,31,109,37],[122,34,109,40,"currentPresences"],[122,50,109,56],[122,51,109,57,"map"],[122,54,109,60],[122,55,109,62,"m"],[122,56,109,63],[122,60,109,68,"m"],[122,61,109,69],[122,62,109,70,"presence_ref"],[122,74,109,82],[122,75,109,83],[123,10,110,16],[123,16,110,22,"joinedPresences"],[123,31,110,37],[123,34,110,40,"newPresences"],[123,46,110,52],[123,47,110,53,"filter"],[123,53,110,59],[123,54,110,61,"m"],[123,55,110,62],[123,59,110,67,"curPresenceRefs"],[123,74,110,82],[123,75,110,83,"indexOf"],[123,82,110,90],[123,83,110,91,"m"],[123,84,110,92],[123,85,110,93,"presence_ref"],[123,97,110,105],[123,98,110,106],[123,101,110,109],[123,102,110,110],[123,103,110,111],[124,10,111,16],[124,16,111,22,"leftPresences"],[124,29,111,35],[124,32,111,38,"currentPresences"],[124,48,111,54],[124,49,111,55,"filter"],[124,55,111,61],[124,56,111,63,"m"],[124,57,111,64],[124,61,111,69,"newPresenceRefs"],[124,76,111,84],[124,77,111,85,"indexOf"],[124,84,111,92],[124,85,111,93,"m"],[124,86,111,94],[124,87,111,95,"presence_ref"],[124,99,111,107],[124,100,111,108],[124,103,111,111],[124,104,111,112],[124,105,111,113],[125,10,112,16],[125,14,112,20,"joinedPresences"],[125,29,112,35],[125,30,112,36,"length"],[125,36,112,42],[125,39,112,45],[125,40,112,46],[125,42,112,48],[126,12,113,20,"joins"],[126,17,113,25],[126,18,113,26,"key"],[126,21,113,29],[126,22,113,30],[126,25,113,33,"joinedPresences"],[126,40,113,48],[127,10,114,16],[128,10,115,16],[128,14,115,20,"leftPresences"],[128,27,115,33],[128,28,115,34,"length"],[128,34,115,40],[128,37,115,43],[128,38,115,44],[128,40,115,46],[129,12,116,20,"leaves"],[129,18,116,26],[129,19,116,27,"key"],[129,22,116,30],[129,23,116,31],[129,26,116,34,"leftPresences"],[129,39,116,47],[130,10,117,16],[131,8,118,12],[131,9,118,13],[131,15,119,17],[132,10,120,16,"joins"],[132,15,120,21],[132,16,120,22,"key"],[132,19,120,25],[132,20,120,26],[132,23,120,29,"newPresences"],[132,35,120,41],[133,8,121,12],[134,6,122,8],[134,7,122,9],[134,8,122,10],[135,6,123,8],[135,13,123,15],[135,17,123,19],[135,18,123,20,"syncDiff"],[135,26,123,28],[135,27,123,29,"state"],[135,32,123,34],[135,34,123,36],[136,8,123,38,"joins"],[136,13,123,43],[137,8,123,45,"leaves"],[138,6,123,52],[138,7,123,53],[138,9,123,55,"onJoin"],[138,15,123,61],[138,17,123,63,"onLeave"],[138,24,123,70],[138,25,123,71],[139,4,124,4],[140,4,125,4],[141,0,126,0],[142,0,127,0],[143,0,128,0],[144,0,129,0],[145,0,130,0],[146,0,131,0],[147,0,132,0],[148,0,133,0],[149,0,134,0],[150,4,135,4],[150,11,135,11,"syncDiff"],[150,19,135,19,"syncDiff"],[150,20,135,20,"state"],[150,25,135,25],[150,27,135,27,"diff"],[150,31,135,31],[150,33,135,33,"onJoin"],[150,39,135,39],[150,41,135,41,"onLeave"],[150,48,135,48],[150,50,135,50],[151,6,136,8],[151,12,136,14],[152,8,136,16,"joins"],[152,13,136,21],[153,8,136,23,"leaves"],[154,6,136,30],[154,7,136,31],[154,10,136,34],[155,8,137,12,"joins"],[155,13,137,17],[155,15,137,19],[155,19,137,23],[155,20,137,24,"transformState"],[155,34,137,38],[155,35,137,39,"diff"],[155,39,137,43],[155,40,137,44,"joins"],[155,45,137,49],[155,46,137,50],[156,8,138,12,"leaves"],[156,14,138,18],[156,16,138,20],[156,20,138,24],[156,21,138,25,"transformState"],[156,35,138,39],[156,36,138,40,"diff"],[156,40,138,44],[156,41,138,45,"leaves"],[156,47,138,51],[157,6,139,8],[157,7,139,9],[158,6,140,8],[158,10,140,12],[158,11,140,13,"onJoin"],[158,17,140,19],[158,19,140,21],[159,8,141,12,"onJoin"],[159,14,141,18],[159,17,141,21,"onJoin"],[159,18,141,21],[159,23,141,27],[159,24,141,29],[159,25,141,30],[160,6,142,8],[161,6,143,8],[161,10,143,12],[161,11,143,13,"onLeave"],[161,18,143,20],[161,20,143,22],[162,8,144,12,"onLeave"],[162,15,144,19],[162,18,144,22,"onLeave"],[162,19,144,22],[162,24,144,28],[162,25,144,30],[162,26,144,31],[163,6,145,8],[164,6,146,8],[164,10,146,12],[164,11,146,13,"map"],[164,14,146,16],[164,15,146,17,"joins"],[164,20,146,22],[164,22,146,24],[164,23,146,25,"key"],[164,26,146,28],[164,28,146,30,"newPresences"],[164,40,146,42],[164,45,146,47],[165,8,147,12],[165,12,147,16,"_a"],[165,14,147,18],[166,8,148,12],[166,14,148,18,"currentPresences"],[166,30,148,34],[166,33,148,37],[166,34,148,38,"_a"],[166,36,148,40],[166,39,148,43,"state"],[166,44,148,48],[166,45,148,49,"key"],[166,48,148,52],[166,49,148,53],[166,55,148,59],[166,59,148,63],[166,63,148,67,"_a"],[166,65,148,69],[166,70,148,74],[166,75,148,79],[166,76,148,80],[166,79,148,83,"_a"],[166,81,148,85],[166,84,148,88],[166,86,148,90],[167,8,149,12,"state"],[167,13,149,17],[167,14,149,18,"key"],[167,17,149,21],[167,18,149,22],[167,21,149,25],[167,25,149,29],[167,26,149,30,"cloneDeep"],[167,35,149,39],[167,36,149,40,"newPresences"],[167,48,149,52],[167,49,149,53],[168,8,150,12],[168,12,150,16,"currentPresences"],[168,28,150,32],[168,29,150,33,"length"],[168,35,150,39],[168,38,150,42],[168,39,150,43],[168,41,150,45],[169,10,151,16],[169,16,151,22,"joinedPresenceRefs"],[169,34,151,40],[169,37,151,43,"state"],[169,42,151,48],[169,43,151,49,"key"],[169,46,151,52],[169,47,151,53],[169,48,151,54,"map"],[169,51,151,57],[169,52,151,59,"m"],[169,53,151,60],[169,57,151,65,"m"],[169,58,151,66],[169,59,151,67,"presence_ref"],[169,71,151,79],[169,72,151,80],[170,10,152,16],[170,16,152,22,"curPresences"],[170,28,152,34],[170,31,152,37,"currentPresences"],[170,47,152,53],[170,48,152,54,"filter"],[170,54,152,60],[170,55,152,62,"m"],[170,56,152,63],[170,60,152,68,"joinedPresenceRefs"],[170,78,152,86],[170,79,152,87,"indexOf"],[170,86,152,94],[170,87,152,95,"m"],[170,88,152,96],[170,89,152,97,"presence_ref"],[170,101,152,109],[170,102,152,110],[170,105,152,113],[170,106,152,114],[170,107,152,115],[171,10,153,16,"state"],[171,15,153,21],[171,16,153,22,"key"],[171,19,153,25],[171,20,153,26],[171,21,153,27,"unshift"],[171,28,153,34],[171,29,153,35],[171,32,153,38,"curPresences"],[171,44,153,50],[171,45,153,51],[172,8,154,12],[173,8,155,12,"onJoin"],[173,14,155,18],[173,15,155,19,"key"],[173,18,155,22],[173,20,155,24,"currentPresences"],[173,36,155,40],[173,38,155,42,"newPresences"],[173,50,155,54],[173,51,155,55],[174,6,156,8],[174,7,156,9],[174,8,156,10],[175,6,157,8],[175,10,157,12],[175,11,157,13,"map"],[175,14,157,16],[175,15,157,17,"leaves"],[175,21,157,23],[175,23,157,25],[175,24,157,26,"key"],[175,27,157,29],[175,29,157,31,"leftPresences"],[175,42,157,44],[175,47,157,49],[176,8,158,12],[176,12,158,16,"currentPresences"],[176,28,158,32],[176,31,158,35,"state"],[176,36,158,40],[176,37,158,41,"key"],[176,40,158,44],[176,41,158,45],[177,8,159,12],[177,12,159,16],[177,13,159,17,"currentPresences"],[177,29,159,33],[177,31,160,16],[178,8,161,12],[178,14,161,18,"presenceRefsToRemove"],[178,34,161,38],[178,37,161,41,"leftPresences"],[178,50,161,54],[178,51,161,55,"map"],[178,54,161,58],[178,55,161,60,"m"],[178,56,161,61],[178,60,161,66,"m"],[178,61,161,67],[178,62,161,68,"presence_ref"],[178,74,161,80],[178,75,161,81],[179,8,162,12,"currentPresences"],[179,24,162,28],[179,27,162,31,"currentPresences"],[179,43,162,47],[179,44,162,48,"filter"],[179,50,162,54],[179,51,162,56,"m"],[179,52,162,57],[179,56,162,62,"presenceRefsToRemove"],[179,76,162,82],[179,77,162,83,"indexOf"],[179,84,162,90],[179,85,162,91,"m"],[179,86,162,92],[179,87,162,93,"presence_ref"],[179,99,162,105],[179,100,162,106],[179,103,162,109],[179,104,162,110],[179,105,162,111],[180,8,163,12,"state"],[180,13,163,17],[180,14,163,18,"key"],[180,17,163,21],[180,18,163,22],[180,21,163,25,"currentPresences"],[180,37,163,41],[181,8,164,12,"onLeave"],[181,15,164,19],[181,16,164,20,"key"],[181,19,164,23],[181,21,164,25,"currentPresences"],[181,37,164,41],[181,39,164,43,"leftPresences"],[181,52,164,56],[181,53,164,57],[182,8,165,12],[182,12,165,16,"currentPresences"],[182,28,165,32],[182,29,165,33,"length"],[182,35,165,39],[182,40,165,44],[182,41,165,45],[182,43,166,16],[182,50,166,23,"state"],[182,55,166,28],[182,56,166,29,"key"],[182,59,166,32],[182,60,166,33],[183,6,167,8],[183,7,167,9],[183,8,167,10],[184,6,168,8],[184,13,168,15,"state"],[184,18,168,20],[185,4,169,4],[186,4,170,4],[187,4,171,4],[187,11,171,11,"map"],[187,14,171,14,"map"],[187,15,171,15,"obj"],[187,18,171,18],[187,20,171,20,"func"],[187,24,171,24],[187,26,171,26],[188,6,172,8],[188,13,172,15,"Object"],[188,19,172,21],[188,20,172,22,"getOwnPropertyNames"],[188,39,172,41],[188,40,172,42,"obj"],[188,43,172,45],[188,44,172,46],[188,45,172,47,"map"],[188,48,172,50],[188,49,172,52,"key"],[188,52,172,55],[188,56,172,60,"func"],[188,60,172,64],[188,61,172,65,"key"],[188,64,172,68],[188,66,172,70,"obj"],[188,69,172,73],[188,70,172,74,"key"],[188,73,172,77],[188,74,172,78],[188,75,172,79],[188,76,172,80],[189,4,173,4],[190,4,174,4],[191,0,175,0],[192,0,176,0],[193,0,177,0],[194,0,178,0],[195,0,179,0],[196,0,180,0],[197,0,181,0],[198,0,182,0],[199,0,183,0],[200,0,184,0],[201,0,185,0],[202,0,186,0],[203,0,187,0],[204,0,188,0],[205,0,189,0],[206,0,190,0],[207,0,191,0],[208,0,192,0],[209,0,193,0],[210,0,194,0],[211,0,195,0],[212,0,196,0],[213,4,197,4],[213,11,197,11,"transformState"],[213,25,197,25,"transformState"],[213,26,197,26,"state"],[213,31,197,31],[213,33,197,33],[214,6,198,8,"state"],[214,11,198,13],[214,14,198,16],[214,18,198,20],[214,19,198,21,"cloneDeep"],[214,28,198,30],[214,29,198,31,"state"],[214,34,198,36],[214,35,198,37],[215,6,199,8],[215,13,199,15,"Object"],[215,19,199,21],[215,20,199,22,"getOwnPropertyNames"],[215,39,199,41],[215,40,199,42,"state"],[215,45,199,47],[215,46,199,48],[215,47,199,49,"reduce"],[215,53,199,55],[215,54,199,56],[215,55,199,57,"newState"],[215,63,199,65],[215,65,199,67,"key"],[215,68,199,70],[215,73,199,75],[216,8,200,12],[216,14,200,18,"presences"],[216,23,200,27],[216,26,200,30,"state"],[216,31,200,35],[216,32,200,36,"key"],[216,35,200,39],[216,36,200,40],[217,8,201,12],[217,12,201,16],[217,19,201,23],[217,23,201,27,"presences"],[217,32,201,36],[217,34,201,38],[218,10,202,16,"newState"],[218,18,202,24],[218,19,202,25,"key"],[218,22,202,28],[218,23,202,29],[218,26,202,32,"presences"],[218,35,202,41],[218,36,202,42,"metas"],[218,41,202,47],[218,42,202,48,"map"],[218,45,202,51],[218,46,202,53,"presence"],[218,54,202,61],[218,58,202,66],[219,12,203,20,"presence"],[219,20,203,28],[219,21,203,29],[219,35,203,43],[219,36,203,44],[219,39,203,47,"presence"],[219,47,203,55],[219,48,203,56],[219,57,203,65],[219,58,203,66],[220,12,204,20],[220,19,204,27,"presence"],[220,27,204,35],[220,28,204,36],[220,37,204,45],[220,38,204,46],[221,12,205,20],[221,19,205,27,"presence"],[221,27,205,35],[221,28,205,36],[221,42,205,50],[221,43,205,51],[222,12,206,20],[222,19,206,27,"presence"],[222,27,206,35],[223,10,207,16],[223,11,207,17],[223,12,207,18],[224,8,208,12],[224,9,208,13],[224,15,209,17],[225,10,210,16,"newState"],[225,18,210,24],[225,19,210,25,"key"],[225,22,210,28],[225,23,210,29],[225,26,210,32,"presences"],[225,35,210,41],[226,8,211,12],[227,8,212,12],[227,15,212,19,"newState"],[227,23,212,27],[228,6,213,8],[228,7,213,9],[228,9,213,11],[228,10,213,12],[228,11,213,13],[228,12,213,14],[229,4,214,4],[230,4,215,4],[231,4,216,4],[231,11,216,11,"cloneDeep"],[231,20,216,20,"cloneDeep"],[231,21,216,21,"obj"],[231,24,216,24],[231,26,216,26],[232,6,217,8],[232,13,217,15,"JSON"],[232,17,217,19],[232,18,217,20,"parse"],[232,23,217,25],[232,24,217,26,"JSON"],[232,28,217,30],[232,29,217,31,"stringify"],[232,38,217,40],[232,39,217,41,"obj"],[232,42,217,44],[232,43,217,45],[232,44,217,46],[233,4,218,4],[234,4,219,4],[235,4,220,4,"onJoin"],[235,10,220,10,"onJoin"],[235,11,220,11,"callback"],[235,19,220,19],[235,21,220,21],[236,6,221,8],[236,10,221,12],[236,11,221,13,"caller"],[236,17,221,19],[236,18,221,20,"onJoin"],[236,24,221,26],[236,27,221,29,"callback"],[236,35,221,37],[237,4,222,4],[238,4,223,4],[239,4,224,4,"onLeave"],[239,11,224,11,"onLeave"],[239,12,224,12,"callback"],[239,20,224,20],[239,22,224,22],[240,6,225,8],[240,10,225,12],[240,11,225,13,"caller"],[240,17,225,19],[240,18,225,20,"onLeave"],[240,25,225,27],[240,28,225,30,"callback"],[240,36,225,38],[241,4,226,4],[242,4,227,4],[243,4,228,4,"onSync"],[243,10,228,10,"onSync"],[243,11,228,11,"callback"],[243,19,228,19],[243,21,228,21],[244,6,229,8],[244,10,229,12],[244,11,229,13,"caller"],[244,17,229,19],[244,18,229,20,"onSync"],[244,24,229,26],[244,27,229,29,"callback"],[244,35,229,37],[245,4,230,4],[246,4,231,4],[247,4,232,4,"inPendingSyncState"],[247,22,232,22,"inPendingSyncState"],[247,23,232,22],[247,25,232,25],[248,6,233,8],[248,13,233,15],[248,14,233,16],[248,18,233,20],[248,19,233,21,"joinRef"],[248,26,233,28],[248,30,233,32],[248,34,233,36],[248,35,233,37,"joinRef"],[248,42,233,44],[248,47,233,49],[248,51,233,53],[248,52,233,54,"channel"],[248,59,233,61],[248,60,233,62,"_joinRef"],[248,68,233,70],[248,69,233,71],[248,70,233,72],[249,4,234,4],[250,2,235,0],[251,2,236,0,"exports"],[251,9,236,7],[251,10,236,8,"default"],[251,17,236,15],[251,20,236,18,"RealtimePresence"],[251,36,236,34],[252,0,236,35],[252,3]],"functionMap":{"names":["<global>","<anonymous>","RealtimePresence","constructor","caller.onJoin","caller.onLeave","caller.onSync","channel._on$argument_2","pendingDiffs.forEach$argument_0","onJoin$argument_0","onLeave$argument_0","onSync$argument_0","syncState","map$argument_1","newPresences.map$argument_0","currentPresences.map$argument_0","newPresences.filter$argument_0","currentPresences.filter$argument_0","syncDiff","onJoin","onLeave","state.key.map$argument_0","leftPresences.map$argument_0","map","Object.getOwnPropertyNames.map$argument_0","transformState","Object.getOwnPropertyNames.reduce$argument_0","presences.metas.map$argument_0","cloneDeep","onSync","inPendingSyncState"],"mappings":"AAA;CCQ;CDI;AEC;ICgB;oBCO,SD;qBEC,SF;oBGC,SH;2CIM;sCCI;aDE;SJG;0CIC;SJS;oBMC;SNO;qBOC;SPO;oBQC;SRE;KDC;IUW;wBCK;SDI;mCCC;yDCG,qBD;6DEC,qBF;4DGC,kDH;8DIC,kDJ;SDW;KVE;IgBW;qBCM,SD;sBEG,SF;wBLE;0DQK,qBR;6DIC,qDJ;SKI;yBLC;2DSI,qBT;uDIC,uDJ;SKK;KhBE;IqBE;mDCC,4BD;KrBC;IuBwB;wDCE;oDCG;iBDK;SDM;KvBC;I0BE;K1BE;IiBE;KjBE;IkBE;KlBE;I2BE;K3BE;I4BE;K5BE;CFC"},"hasCjsExports":true},"type":"js/module"}]}